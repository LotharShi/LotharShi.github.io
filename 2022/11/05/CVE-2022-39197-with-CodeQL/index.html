<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Introduction  Normally people use various tools to test and find vulnerabilities on other softwares, but will ignore that the tools themselves could also be vulnerable. CS (Cobalt Strike) is an exampl">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2022-39197 with CodeQL">
<meta property="og:url" content="http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/index.html">
<meta property="og:site_name" content="Where Lothar Writes Blogs">
<meta property="og:description" content="Introduction  Normally people use various tools to test and find vulnerabilities on other softwares, but will ignore that the tools themselves could also be vulnerable. CS (Cobalt Strike) is an exampl">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://lotharshi.github.io/images/image-20221105153204300.png">
<meta property="og:image" content="http://lotharshi.github.io/images/image-20221105114546838.png">
<meta property="og:image" content="http://lotharshi.github.io/images/image-20221105120358839.png">
<meta property="og:image" content="http://lotharshi.github.io/images/image-2022105120634393.png">
<meta property="og:image" content="http://lotharshi.github.io/images/image-20221105121330861.png">
<meta property="og:image" content="http://lotharshi.github.io/images/image-20221105124100569.png">
<meta property="og:image" content="http://lotharshi.github.io/images/image-20221105141249783.png">
<meta property="og:image" content="http://lotharshi.github.io/images/image-20221105151150668.png">
<meta property="article:published_time" content="2022-11-05T02:48:01.000Z">
<meta property="article:modified_time" content="2023-01-04T06:52:48.194Z">
<meta property="article:author" content="Lothar">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://lotharshi.github.io/images/image-20221105153204300.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>CVE-2022-39197 with CodeQL</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/categories/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/LotharShi">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2023/01/03/CVE-2021-44228-with-CodeQL/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2022/11/01/Webcam%20Exploitation%20Using%20Pocsuite3/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&text=CVE-2022-39197 with CodeQL"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&title=CVE-2022-39197 with CodeQL"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&is_video=false&description=CVE-2022-39197 with CodeQL"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CVE-2022-39197 with CodeQL&body=Check out this article: http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&title=CVE-2022-39197 with CodeQL"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&title=CVE-2022-39197 with CodeQL"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&title=CVE-2022-39197 with CodeQL"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&title=CVE-2022-39197 with CodeQL"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&name=CVE-2022-39197 with CodeQL&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&t=CVE-2022-39197 with CodeQL"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vulnerability-Analysis"><span class="toc-number">2.</span> <span class="toc-text">Vulnerability Analysis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Swing"><span class="toc-number">2.1.</span> <span class="toc-text">Swing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arbitrary-Instantiatation"><span class="toc-number">2.2.</span> <span class="toc-text">Arbitrary Instantiatation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Path"><span class="toc-number">2.3.</span> <span class="toc-text">The Path</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Using-CodeQL"><span class="toc-number">3.</span> <span class="toc-text">Using CodeQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Create-Database"><span class="toc-number">3.1.</span> <span class="toc-text">Create Database</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Querying"><span class="toc-number">3.2.</span> <span class="toc-text">Querying</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Result"><span class="toc-number">3.3.</span> <span class="toc-text">Result</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">4.</span> <span class="toc-text">References</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        CVE-2022-39197 with CodeQL
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Lothar</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-11-05T02:48:01.000Z" itemprop="datePublished">2022-11-05</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/CVEs/">CVEs</a> › <a class="category-link" href="/categories/CVEs/CodeQL/">CodeQL</a>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><img src="/images/image-20221105153204300.png" alt="image-20221105153204300" style="zoom:50%;" />

<p>Normally people use various tools to test and find vulnerabilities on other softwares, but will ignore that the tools themselves could also be vulnerable. <a target="_blank" rel="noopener" href="https://www.cobaltstrike.com/">CS (Cobalt Strike)</a> is an example. In the past few years, there were some CVEs discovered inside CS, like CVE-2021-36798 and CVE-2022-23317. But the latest CVE-2022-39197 could be much more fun. </p>
<h2 id="Vulnerability-Analysis"><a href="#Vulnerability-Analysis" class="headerlink" title="Vulnerability Analysis"></a>Vulnerability Analysis</h2><h3 id="Swing"><a href="#Swing" class="headerlink" title="Swing"></a>Swing</h3><p>The very beginning is about a Java GUI library called <strong>Swing</strong>. We know that CS written by Java, and we should also know that all its interfaces which people could interect are written by Swing. </p>
<p>Let’s start from an example.</p>
<img src="/images/image-20221105114546838.png" alt="image-20221105114546838" style="zoom:50%;" />

<p>Here, an <code>&quot;&lt;html&gt;&lt;img src=Lothar.jpg&gt;&quot;</code> payload is inserted in to the <code>JLabel</code>. Then we can see that the result is a render failure icon. But the <code>src</code> is some file doesn’t exist now, what if the value is some remote address? The answer is that, a GET request will be sent to the remote server. </p>
<p>Looking up the <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/tutorial/uiswing/components/html.html">official document</a>, and find that there is some specification about this <code>&lt;html&gt;</code> usage. </p>
<blockquote>
<p>To specify that a component’s text has HTML formatting, just put the <code>&lt;html&gt;</code> tag at the beginning of the text, then use any valid HTML in the remainder.</p>
</blockquote>
<p>See, if a <code>&lt;html&gt;</code> tag is placed at the very beginning, then the remainder will be considered as HTML. Seems like XSS could easily happens here! But if you test the common CSS then, you will find that <code>&lt;script&gt;</code> is not working here. </p>
<p>This is because the Swing builds up the HTML parsing engine by itself. So it refuses to execute the js code by <code>&lt;script&gt;</code>. </p>
<img src="/images/image-20221105120358839.png" alt="image-20221105120358839" style="zoom:50%;" />

<h3 id="Arbitrary-Instantiatation"><a href="#Arbitrary-Instantiatation" class="headerlink" title="Arbitrary Instantiatation"></a>Arbitrary Instantiatation</h3><p>However, it’s also because it builds up the HTML parsing enging by itself, something interesting has been made. Just a few lines before the previous one, we can see that if it is a <code>object</code> tag, a <code>ObjectView</code> will be called.</p>
<img src="/images/image-2022105120634393.png" alt="image-20221105120634393" style="zoom:50%;" />

<p>And the <code>ObjectView</code> is like:</p>
<img src="/images/image-20221105121330861.png" alt="image-20221105121330861" style="zoom:50%;" />

<p>From the code, we can tell that if <code>CLASSID</code> is fetched, the class will be instantiated and parameters will be passed. A small demo is provided here.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">createAndShowGUI</span><span class="params">()</span> &#123;</span><br><span class="line">        JFrame.setDefaultLookAndFeelDecorated(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">JFrame</span> <span class="variable">frame</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JFrame</span>(<span class="string">&quot;Object Example&quot;</span>);</span><br><span class="line">        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span><br><span class="line"></span><br><span class="line">        <span class="type">JLabel</span> <span class="variable">label2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JLabel</span>(<span class="string">&quot;&lt;html&gt;&lt;object classid=&#x27;javax.swing.JLabel&#x27;&gt;&lt;param name=&#x27;text&#x27; value=&#x27;sample text&#x27;&gt;&lt;/object&gt;&quot;</span>);</span><br><span class="line">        frame.getContentPane().add(label2);</span><br><span class="line">        frame.setSize(<span class="number">300</span>,<span class="number">300</span>);</span><br><span class="line">        frame.pack();</span><br><span class="line">        frame.setVisible(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        javax.swing.SwingUtilities.invokeLater(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                createAndShowGUI();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/images/image-20221105124100569.png" alt="image-20221105124100569" style="zoom:50%;" />

<p>We’ll go deeper into the <code>ObjectView</code> to see if there’s any requirement.</p>
<p>Inside <code>ObjectView</code> :</p>
<ul>
<li><code>Object var4 = var3.newInstance();</code> indicates that the class should be able to be construcetd without parameters;</li>
<li><code>var4 instanceof Component</code> indicates that the class should inherit from the <code>Component</code>.</li>
</ul>
<p>Inside <code>setParameters</code> :</p>
<ul>
<li><code>var7 instanceof String</code> indicates that the parameter should be a String type;</li>
<li><code>Method var9 = var5[var6].getWriteMethod();</code> indicates that the parameter should have a method which can write the property value;</li>
<li><code>var10.length != 1</code> indicates that the method should be able to recieve only 1 parameter.</li>
</ul>
<p>Now, we have summarized the requirements. And according to these summary, it’s easy to think of an idea that this method should be a method which looks like a <code>setxxxxxx</code>.</p>
<h3 id="The-Path"><a href="#The-Path" class="headerlink" title="The Path"></a>The Path</h3><p>After some search in the libraries, a path is found:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org.apache.batik.swing.JSVGCanvas--&gt;setURI</span><br></pre></td></tr></table></figure>

<img src="/images/image-20221105141249783.png" alt="image-20221105141249783" style="zoom:50%;" />

<p>From the code of path, we can identify that the purpose of this method is to set the address of SVG and to load the SVG figure remotely. </p>
<p>Therefore, if the SVG file is malicious, then remote code execution could happen. </p>
<h2 id="Using-CodeQL"><a href="#Using-CodeQL" class="headerlink" title="Using CodeQL"></a>Using CodeQL</h2><h3 id="Create-Database"><a href="#Create-Database" class="headerlink" title="Create Database"></a>Create Database</h3><p>To use CodeQL, the first time should always be creating a database. But unlike using CodeQL to audit open-source software, it might be more complex this time. Since Cobalt Strike is close-sourced, some decompilation of the <code>.jar</code> is needed here. IDEA decompiler plugin could help.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create cobaltstrike45-db --language=java</span><br></pre></td></tr></table></figure>

<h3 id="Querying"><a href="#Querying" class="headerlink" title="Querying"></a>Querying</h3><p><a target="_blank" rel="noopener" href="https://codeql.github.com/docs/">Official Documentation</a></p>
<p>According the previous analysis, especially the requirements, we can write the querying statements.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import java</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> <span class="keyword">Method</span> <span class="keyword">method</span></span><br><span class="line"><span class="keyword">where</span> method.getDeclaringType().getASupertype().getASupertype().hasQualifiedName(&quot;java.awt&quot;, &quot;Component&quot;) <span class="keyword">and</span> </span><br><span class="line">method.getName().indexOf(&quot;set&quot;) <span class="operator">=</span> <span class="number">0</span> <span class="keyword">and</span> </span><br><span class="line">method.getParameter(<span class="number">0</span>).getType() instanceof TypeString</span><br><span class="line"><span class="keyword">select</span> method.getName(), method.getLocation()</span><br></pre></td></tr></table></figure>

<p> Then after the querying is completed, we can see the list of calls found by CodeQL.</p>
<img src="/images/image-20221105151150668.png" alt="image-20221105151150668" style="zoom:50%;" />

<h3 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h3><p>We can find that the querying result points to the same method as we have analyzed before. </p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><p><a target="_blank" rel="noopener" href="https://github.com/its-arun/CVE-2022-39197">A Nice PoC</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Eb0pQ-1ebLSKPUFC7zS6dg">Analysis1</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzkzNjMxNDM0Mg==&mid=2247485450&idx=1&sn=5662a9f2c081fc8521eee651b357323f&chksm=c2a1dc83f5d655957cf2a1c88adf45cd0d028316f536e0a8a18c9e7cb0440869ed4077822ce8&mpshare=1&scene=1&srcid=1017PFOrquxivFM2ck4Prl9m&sharer_sharetime=1665993698480&sharer_shareid=8c0858e06fee9d607c68521b3949c3e9#rd">Analysis2</a></p>
<p><a target="_blank" rel="noopener" href="https://forum.butian.net/share/1975">Analysis3</a></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/categories/">Writing</a></li>
         
          <li><a target="_blank" rel="noopener" href="http://github.com/LotharShi">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vulnerability-Analysis"><span class="toc-number">2.</span> <span class="toc-text">Vulnerability Analysis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Swing"><span class="toc-number">2.1.</span> <span class="toc-text">Swing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Arbitrary-Instantiatation"><span class="toc-number">2.2.</span> <span class="toc-text">Arbitrary Instantiatation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Path"><span class="toc-number">2.3.</span> <span class="toc-text">The Path</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Using-CodeQL"><span class="toc-number">3.</span> <span class="toc-text">Using CodeQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Create-Database"><span class="toc-number">3.1.</span> <span class="toc-text">Create Database</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Querying"><span class="toc-number">3.2.</span> <span class="toc-text">Querying</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Result"><span class="toc-number">3.3.</span> <span class="toc-text">Result</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#References"><span class="toc-number">4.</span> <span class="toc-text">References</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&text=CVE-2022-39197 with CodeQL"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&title=CVE-2022-39197 with CodeQL"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&is_video=false&description=CVE-2022-39197 with CodeQL"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=CVE-2022-39197 with CodeQL&body=Check out this article: http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&title=CVE-2022-39197 with CodeQL"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&title=CVE-2022-39197 with CodeQL"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&title=CVE-2022-39197 with CodeQL"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&title=CVE-2022-39197 with CodeQL"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&name=CVE-2022-39197 with CodeQL&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://lotharshi.github.io/2022/11/05/CVE-2022-39197-with-CodeQL/&t=CVE-2022-39197 with CodeQL"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022-2023
    Lothar
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/categories/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/LotharShi">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RJJPDKLTJM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-RJJPDKLTJM');
    </script>

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
